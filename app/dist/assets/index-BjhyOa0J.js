(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var me,w,at,lt,L,We,ct,ut,ft,xe,Te,Ee,ue={},fe=[],qt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ye=Array.isArray;function P(t,e){for(var n in e)t[n]=e[n];return t}function Re(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function zt(t,e,n){var r,s,o,i={};for(o in e)o=="key"?r=e[o]:o=="ref"?s=e[o]:i[o]=e[o];if(arguments.length>2&&(i.children=arguments.length>3?me.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)i[o]===void 0&&(i[o]=t.defaultProps[o]);return le(t,i,r,s,null)}function le(t,e,n,r,s){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++at,__i:-1,__u:0};return s==null&&w.vnode!=null&&w.vnode(o),o}function ne(t){return t.children}function K(t,e){this.props=t,this.context=e}function q(t,e){if(e==null)return t.__?q(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?q(t):null}function Zt(t){if(t.__P&&t.__d){var e=t.__v,n=e.__e,r=[],s=[],o=P({},e);o.__v=e.__v+1,w.vnode&&w.vnode(o),Pe(t.__P,o,e,t.__n,t.__P.namespaceURI,32&e.__u?[n]:null,r,n??q(e),!!(32&e.__u),s),o.__v=e.__v,o.__.__k[o.__i]=o,pt(r,o,s),e.__e=e.__=null,o.__e!=n&&_t(o)}}function _t(t){if((t=t.__)!=null&&t.__c!=null)return t.__e=t.__c.base=null,t.__k.some(function(e){if(e!=null&&e.__e!=null)return t.__e=t.__c.base=e.__e}),_t(t)}function Ye(t){(!t.__d&&(t.__d=!0)&&L.push(t)&&!_e.__r++||We!=w.debounceRendering)&&((We=w.debounceRendering)||ct)(_e)}function _e(){for(var t,e=1;L.length;)L.length>e&&L.sort(ut),t=L.shift(),e=L.length,Zt(t);_e.__r=0}function dt(t,e,n,r,s,o,i,a,u,c,_){var l,h,f,v,m,b,y,p=r&&r.__k||fe,S=e.length;for(u=jt(n,e,p,u,S),l=0;l<S;l++)(f=n.__k[l])!=null&&(h=f.__i!=-1&&p[f.__i]||ue,f.__i=l,b=Pe(t,f,h,s,o,i,a,u,c,_),v=f.__e,f.ref&&h.ref!=f.ref&&(h.ref&&Fe(h.ref,null,f),_.push(f.ref,f.__c||v,f)),m==null&&v!=null&&(m=v),(y=!!(4&f.__u))||h.__k===f.__k?u=ht(f,u,t,y):typeof f.type=="function"&&b!==void 0?u=b:v&&(u=v.nextSibling),f.__u&=-7);return n.__e=m,u}function jt(t,e,n,r,s){var o,i,a,u,c,_=n.length,l=_,h=0;for(t.__k=new Array(s),o=0;o<s;o++)(i=e[o])!=null&&typeof i!="boolean"&&typeof i!="function"?(typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?i=t.__k[o]=le(null,i,null,null,null):ye(i)?i=t.__k[o]=le(ne,{children:i},null,null,null):i.constructor===void 0&&i.__b>0?i=t.__k[o]=le(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):t.__k[o]=i,u=o+h,i.__=t,i.__b=t.__b+1,a=null,(c=i.__i=Xt(i,n,u,l))!=-1&&(l--,(a=n[c])&&(a.__u|=2)),a==null||a.__v==null?(c==-1&&(s>_?h--:s<_&&h++),typeof i.type!="function"&&(i.__u|=4)):c!=u&&(c==u-1?h--:c==u+1?h++:(c>u?h--:h++,i.__u|=4))):t.__k[o]=null;if(l)for(o=0;o<_;o++)(a=n[o])!=null&&(2&a.__u)==0&&(a.__e==r&&(r=q(a)),mt(a,a));return r}function ht(t,e,n,r){var s,o;if(typeof t.type=="function"){for(s=t.__k,o=0;s&&o<s.length;o++)s[o]&&(s[o].__=t,e=ht(s[o],e,n,r));return e}t.__e!=e&&(r&&(e&&t.type&&!e.parentNode&&(e=q(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Xt(t,e,n,r){var s,o,i,a=t.key,u=t.type,c=e[n],_=c!=null&&(2&c.__u)==0;if(c===null&&a==null||_&&a==c.key&&u==c.type)return n;if(r>(_?1:0)){for(s=n-1,o=n+1;s>=0||o<e.length;)if((c=e[i=s>=0?s--:o++])!=null&&(2&c.__u)==0&&a==c.key&&u==c.type)return i}return-1}function Ve(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||qt.test(e)?n:n+"px"}function oe(t,e,n,r,s){var o,i;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||Ve(t.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||Ve(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(ft,"$1")),i=e.toLowerCase(),e=i in t||e=="onFocusOut"||e=="onFocusIn"?i.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r?n.u=r.u:(n.u=xe,t.addEventListener(e,o?Ee:Te,o)):t.removeEventListener(e,o?Ee:Te,o);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function qe(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=xe++;else if(e.t<n.u)return;return n(w.event?w.event(e):e)}}}function Pe(t,e,n,r,s,o,i,a,u,c){var _,l,h,f,v,m,b,y,p,S,k,j,He,se,be,x=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(u=!!(32&n.__u),o=[a=e.__e=n.__e]),(_=w.__b)&&_(e);e:if(typeof x=="function")try{if(y=e.props,p="prototype"in x&&x.prototype.render,S=(_=x.contextType)&&r[_.__c],k=_?S?S.props.value:_.__:r,n.__c?b=(l=e.__c=n.__c).__=l.__E:(p?e.__c=l=new x(y,k):(e.__c=l=new K(y,k),l.constructor=x,l.render=Kt),S&&S.sub(l),l.state||(l.state={}),l.__n=r,h=l.__d=!0,l.__h=[],l._sb=[]),p&&l.__s==null&&(l.__s=l.state),p&&x.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=P({},l.__s)),P(l.__s,x.getDerivedStateFromProps(y,l.__s))),f=l.props,v=l.state,l.__v=e,h)p&&x.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),p&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(p&&x.getDerivedStateFromProps==null&&y!==f&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(y,k),e.__v==n.__v||!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(y,l.__s,k)===!1){e.__v!=n.__v&&(l.props=y,l.state=l.__s,l.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(Y){Y&&(Y.__=e)}),fe.push.apply(l.__h,l._sb),l._sb=[],l.__h.length&&i.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(y,l.__s,k),p&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(f,v,m)})}if(l.context=k,l.props=y,l.__P=t,l.__e=!1,j=w.__r,He=0,p)l.state=l.__s,l.__d=!1,j&&j(e),_=l.render(l.props,l.state,l.context),fe.push.apply(l.__h,l._sb),l._sb=[];else do l.__d=!1,j&&j(e),_=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++He<25);l.state=l.__s,l.getChildContext!=null&&(r=P(P({},r),l.getChildContext())),p&&!h&&l.getSnapshotBeforeUpdate!=null&&(m=l.getSnapshotBeforeUpdate(f,v)),se=_!=null&&_.type===ne&&_.key==null?vt(_.props.children):_,a=dt(t,ye(se)?se:[se],e,n,r,s,o,i,a,u,c),l.base=e.__e,e.__u&=-161,l.__h.length&&i.push(l),b&&(l.__E=l.__=null)}catch(Y){if(e.__v=null,u||o!=null)if(Y.then){for(e.__u|=u?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;o[o.indexOf(a)]=null,e.__e=a}else{for(be=o.length;be--;)Re(o[be]);Ce(e)}else e.__e=n.__e,e.__k=n.__k,Y.then||Ce(e);w.__e(Y,e,n)}else o==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):a=e.__e=Jt(n.__e,e,n,r,s,o,i,u,c);return(_=w.diffed)&&_(e),128&e.__u?void 0:a}function Ce(t){t&&(t.__c&&(t.__c.__e=!0),t.__k&&t.__k.some(Ce))}function pt(t,e,n){for(var r=0;r<n.length;r++)Fe(n[r],n[++r],n[++r]);w.__c&&w.__c(e,t),t.some(function(s){try{t=s.__h,s.__h=[],t.some(function(o){o.call(s)})}catch(o){w.__e(o,s.__v)}})}function vt(t){return typeof t!="object"||t==null||t.__b>0?t:ye(t)?t.map(vt):P({},t)}function Jt(t,e,n,r,s,o,i,a,u){var c,_,l,h,f,v,m,b=n.props||ue,y=e.props,p=e.type;if(p=="svg"?s="http://www.w3.org/2000/svg":p=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),o!=null){for(c=0;c<o.length;c++)if((f=o[c])&&"setAttribute"in f==!!p&&(p?f.localName==p:f.nodeType==3)){t=f,o[c]=null;break}}if(t==null){if(p==null)return document.createTextNode(y);t=document.createElementNS(s,p,y.is&&y),a&&(w.__m&&w.__m(e,o),a=!1),o=null}if(p==null)b===y||a&&t.data==y||(t.data=y);else{if(o=o&&me.call(t.childNodes),!a&&o!=null)for(b={},c=0;c<t.attributes.length;c++)b[(f=t.attributes[c]).name]=f.value;for(c in b)f=b[c],c=="dangerouslySetInnerHTML"?l=f:c=="children"||c in y||c=="value"&&"defaultValue"in y||c=="checked"&&"defaultChecked"in y||oe(t,c,null,f,s);for(c in y)f=y[c],c=="children"?h=f:c=="dangerouslySetInnerHTML"?_=f:c=="value"?v=f:c=="checked"?m=f:a&&typeof f!="function"||b[c]===f||oe(t,c,f,b[c],s);if(_)a||l&&(_.__html==l.__html||_.__html==t.innerHTML)||(t.innerHTML=_.__html),e.__k=[];else if(l&&(t.innerHTML=""),dt(e.type=="template"?t.content:t,ye(h)?h:[h],e,n,r,p=="foreignObject"?"http://www.w3.org/1999/xhtml":s,o,i,o?o[0]:n.__k&&q(n,0),a,u),o!=null)for(c=o.length;c--;)Re(o[c]);a||(c="value",p=="progress"&&v==null?t.removeAttribute("value"):v!=null&&(v!==t[c]||p=="progress"&&!v||p=="option"&&v!=b[c])&&oe(t,c,v,b[c],s),c="checked",m!=null&&m!=t[c]&&oe(t,c,m,b[c],s))}return t}function Fe(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(s){w.__e(s,n)}}function mt(t,e,n){var r,s;if(w.unmount&&w.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||Fe(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){w.__e(o,e)}r.base=r.__P=null}if(r=t.__k)for(s=0;s<r.length;s++)r[s]&&mt(r[s],e,n||typeof t.type!="function");n||Re(t.__e),t.__c=t.__=t.__e=void 0}function Kt(t,e,n){return this.constructor(t,n)}function Gt(t,e,n){var r,s,o,i;e==document&&(e=document.documentElement),w.__&&w.__(t,e),s=(r=!1)?null:e.__k,o=[],i=[],Pe(e,t=e.__k=zt(ne,null,[t]),s||ue,ue,e.namespaceURI,s?null:e.firstChild?me.call(e.childNodes):null,o,s?s.__e:e.firstChild,r,i),pt(o,t,i)}me=fe.slice,w={__e:function(t,e,n,r){for(var s,o,i;e=e.__;)if((s=e.__c)&&!s.__)try{if((o=s.constructor)&&o.getDerivedStateFromError!=null&&(s.setState(o.getDerivedStateFromError(t)),i=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(t,r||{}),i=s.__d),i)return s.__E=s}catch(a){t=a}throw t}},at=0,lt=function(t){return t!=null&&t.constructor===void 0},K.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=P({},this.state),typeof t=="function"&&(t=t(P({},n),this.props)),t&&P(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Ye(this))},K.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Ye(this))},K.prototype.render=ne,L=[],ct=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ut=function(t,e){return t.__v.__b-e.__v.__b},_e.__r=0,ft=/(PointerCapture)$|Capture$/i,xe=0,Te=qe(!1),Ee=qe(!0);var Qt=0;function d(t,e,n,r,s,o){e||(e={});var i,a,u=e;if("ref"in u)for(a in u={},e)a=="ref"?i=e[a]:u[a]=e[a];var c={type:t,props:u,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Qt,__i:-1,__u:0,__source:s,__self:o};if(typeof t=="function"&&(i=t.defaultProps))for(a in i)u[a]===void 0&&(u[a]=i[a]);return w.vnode&&w.vnode(c),c}var Q,E,Se,ze,ee=0,yt=[],C=w,Ze=C.__b,je=C.__r,Xe=C.diffed,Je=C.__c,Ke=C.unmount,Ge=C.__;function Me(t,e){C.__h&&C.__h(E,t,ee||e),ee=0;var n=E.__H||(E.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function B(t){return ee=1,en(wt,t)}function en(t,e,n){var r=Me(Q++,2);if(r.t=t,!r.__c&&(r.__=[wt(void 0,e),function(a){var u=r.__N?r.__N[0]:r.__[0],c=r.t(u,a);u!==c&&(r.__N=[c,r.__[1]],r.__c.setState({}))}],r.__c=E,!E.__f)){var s=function(a,u,c){if(!r.__c.__H)return!0;var _=r.__c.__H.__.filter(function(h){return h.__c});if(_.every(function(h){return!h.__N}))return!o||o.call(this,a,u,c);var l=r.__c.props!==a;return _.some(function(h){if(h.__N){var f=h.__[0];h.__=h.__N,h.__N=void 0,f!==h.__[0]&&(l=!0)}}),o&&o.call(this,a,u,c)||l};E.__f=!0;var o=E.shouldComponentUpdate,i=E.componentWillUpdate;E.componentWillUpdate=function(a,u,c){if(this.__e){var _=o;o=void 0,s(a,u,c),o=_}i&&i.call(this,a,u,c)},E.shouldComponentUpdate=s}return r.__N||r.__}function $e(t,e){var n=Me(Q++,3);!C.__s&&gt(n.__H,e)&&(n.__=t,n.u=e,E.__H.__h.push(n))}function V(t){return ee=5,ge(function(){return{current:t}},[])}function ge(t,e){var n=Me(Q++,7);return gt(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Ue(t,e){return ee=8,ge(function(){return t},e)}function tn(){for(var t;t=yt.shift();){var e=t.__H;if(t.__P&&e)try{e.__h.some(ce),e.__h.some(De),e.__h=[]}catch(n){e.__h=[],C.__e(n,t.__v)}}}C.__b=function(t){E=null,Ze&&Ze(t)},C.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Ge&&Ge(t,e)},C.__r=function(t){je&&je(t),Q=0;var e=(E=t.__c).__H;e&&(Se===E?(e.__h=[],E.__h=[],e.__.some(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.some(ce),e.__h.some(De),e.__h=[],Q=0)),Se=E},C.diffed=function(t){Xe&&Xe(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(yt.push(e)!==1&&ze===C.requestAnimationFrame||((ze=C.requestAnimationFrame)||nn)(tn)),e.__H.__.some(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Se=E=null},C.__c=function(t,e){e.some(function(n){try{n.__h.some(ce),n.__h=n.__h.filter(function(r){return!r.__||De(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],C.__e(r,n.__v)}}),Je&&Je(t,e)},C.unmount=function(t){Ke&&Ke(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.some(function(r){try{ce(r)}catch(s){e=s}}),n.__H=void 0,e&&C.__e(e,n.__v))};var Qe=typeof requestAnimationFrame=="function";function nn(t){var e,n=function(){clearTimeout(r),Qe&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,35);Qe&&(e=requestAnimationFrame(n))}function ce(t){var e=E,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),E=e}function De(t){var e=E;t.__c=t.__(),E=e}function gt(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function wt(t,e){return typeof e=="function"?e(t):e}var rn=Symbol.for("preact-signals");function we(){if(M>1)M--;else{for(var t,e=!1;G!==void 0;){var n=G;for(G=void 0,Ne++;n!==void 0;){var r=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&Tt(n))try{n.c()}catch(s){e||(t=s,e=!0)}n=r}}if(Ne=0,M--,e)throw t}}function sn(t){if(M>0)return t();M++;try{return t()}finally{we()}}var g=void 0;function bt(t){var e=g;g=void 0;try{return t()}finally{g=e}}var G=void 0,M=0,Ne=0,de=0;function St(t){if(g!==void 0){var e=t.n;if(e===void 0||e.t!==g)return e={i:0,S:t,p:g.s,n:void 0,t:g,e:void 0,x:void 0,r:e},g.s!==void 0&&(g.s.n=e),g.s=e,t.n=e,32&g.f&&t.S(e),e;if(e.i===-1)return e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=g.s,e.n=void 0,g.s.n=e,g.s=e),e}}function $(t,e){this.v=t,this.i=0,this.n=void 0,this.t=void 0,this.W=e?.watched,this.Z=e?.unwatched,this.name=e?.name}$.prototype.brand=rn;$.prototype.h=function(){return!0};$.prototype.S=function(t){var e=this,n=this.t;n!==t&&t.e===void 0&&(t.x=n,this.t=t,n!==void 0?n.e=t:bt(function(){var r;(r=e.W)==null||r.call(e)}))};$.prototype.U=function(t){var e=this;if(this.t!==void 0){var n=t.e,r=t.x;n!==void 0&&(n.x=r,t.e=void 0),r!==void 0&&(r.e=n,t.x=void 0),t===this.t&&(this.t=r,r===void 0&&bt(function(){var s;(s=e.Z)==null||s.call(e)}))}};$.prototype.subscribe=function(t){var e=this;return re(function(){var n=e.value,r=g;g=void 0;try{t(n)}finally{g=r}},{name:"sub"})};$.prototype.valueOf=function(){return this.value};$.prototype.toString=function(){return this.value+""};$.prototype.toJSON=function(){return this.value};$.prototype.peek=function(){var t=g;g=void 0;try{return this.value}finally{g=t}};Object.defineProperty($.prototype,"value",{get:function(){var t=St(this);return t!==void 0&&(t.i=this.i),this.v},set:function(t){if(t!==this.v){if(Ne>100)throw new Error("Cycle detected");this.v=t,this.i++,de++,M++;try{for(var e=this.t;e!==void 0;e=e.x)e.t.N()}finally{we()}}}});function R(t,e){return new $(t,e)}function Tt(t){for(var e=t.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function Et(t){for(var e=t.s;e!==void 0;e=e.n){var n=e.S.n;if(n!==void 0&&(e.r=n),e.S.n=e,e.i=-1,e.n===void 0){t.s=e;break}}}function Ct(t){for(var e=t.s,n=void 0;e!==void 0;){var r=e.p;e.i===-1?(e.S.U(e),r!==void 0&&(r.n=e.n),e.n!==void 0&&(e.n.p=r)):n=e,e.S.n=e.r,e.r!==void 0&&(e.r=void 0),e=r}t.s=n}function W(t,e){$.call(this,void 0),this.x=t,this.s=void 0,this.g=de-1,this.f=4,this.W=e?.watched,this.Z=e?.unwatched,this.name=e?.name}W.prototype=new $;W.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===de))return!0;if(this.g=de,this.f|=1,this.i>0&&!Tt(this))return this.f&=-2,!0;var t=g;try{Et(this),g=this;var e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return g=t,Ct(this),this.f&=-2,!0};W.prototype.S=function(t){if(this.t===void 0){this.f|=36;for(var e=this.s;e!==void 0;e=e.n)e.S.S(e)}$.prototype.S.call(this,t)};W.prototype.U=function(t){if(this.t!==void 0&&($.prototype.U.call(this,t),this.t===void 0)){this.f&=-33;for(var e=this.s;e!==void 0;e=e.n)e.S.U(e)}};W.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var t=this.t;t!==void 0;t=t.x)t.t.N()}};Object.defineProperty(W.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var t=St(this);if(this.h(),t!==void 0&&(t.i=this.i),16&this.f)throw this.v;return this.v}});function Ae(t,e){return new W(t,e)}function $t(t){var e=t.u;if(t.u=void 0,typeof e=="function"){M++;var n=g;g=void 0;try{e()}catch(r){throw t.f&=-2,t.f|=8,Le(t),r}finally{g=n,we()}}}function Le(t){for(var e=t.s;e!==void 0;e=e.n)e.S.U(e);t.x=void 0,t.s=void 0,$t(t)}function on(t){if(g!==this)throw new Error("Out-of-order effect");Ct(this),g=t,this.f&=-2,8&this.f&&Le(this),we()}function z(t,e){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=e?.name}z.prototype.c=function(){var t=this.S();try{if(8&this.f||this.x===void 0)return;var e=this.x();typeof e=="function"&&(this.u=e)}finally{t()}};z.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,$t(this),Et(this),M++;var t=g;return g=this,on.bind(this,t)};z.prototype.N=function(){2&this.f||(this.f|=2,this.o=G,G=this)};z.prototype.d=function(){this.f|=8,1&this.f||Le(this)};z.prototype.dispose=function(){this.d()};function re(t,e){var n=new z(t,e);try{n.c()}catch(s){throw n.d(),s}var r=n.d.bind(n);return r[Symbol.dispose]=r,r}var Ut,ie,an=typeof window<"u"&&!!window.__PREACT_SIGNALS_DEVTOOLS__,Dt=[];re(function(){Ut=this.N})();function Z(t,e){w[t]=e.bind(null,w[t]||function(){})}function he(t){if(ie){var e=ie;ie=void 0,e()}ie=t&&t.S()}function Nt(t){var e=this,n=t.data,r=cn(n);r.value=n;var s=ge(function(){for(var a=e,u=e.__v;u=u.__;)if(u.__c){u.__c.__$f|=4;break}var c=Ae(function(){var f=r.value.value;return f===0?0:f===!0?"":f||""}),_=Ae(function(){return!Array.isArray(c.value)&&!lt(c.value)}),l=re(function(){if(this.N=At,_.value){var f=c.value;a.__v&&a.__v.__e&&a.__v.__e.nodeType===3&&(a.__v.__e.data=f)}}),h=e.__$u.d;return e.__$u.d=function(){l(),h.call(this)},[_,c]},[]),o=s[0],i=s[1];return o.value?i.peek():i.value}Nt.displayName="ReactiveTextNode";Object.defineProperties($.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:Nt},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});Z("__b",function(t,e){if(typeof e.type=="string"){var n,r=e.props;for(var s in r)if(s!=="children"){var o=r[s];o instanceof $&&(n||(e.__np=n={}),n[s]=o,r[s]=o.peek())}}t(e)});Z("__r",function(t,e){if(t(e),e.type!==ne){he();var n,r=e.__c;r&&(r.__$f&=-2,(n=r.__$u)===void 0&&(r.__$u=n=(function(s,o){var i;return re(function(){i=this},{name:o}),i.c=s,i})(function(){var s;an&&((s=n.y)==null||s.call(n)),r.__$f|=1,r.setState({})},typeof e.type=="function"?e.type.displayName||e.type.name:""))),he(n)}});Z("__e",function(t,e,n,r){he(),t(e,n,r)});Z("diffed",function(t,e){he();var n;if(typeof e.type=="string"&&(n=e.__e)){var r=e.__np,s=e.props;if(r){var o=n.U;if(o)for(var i in o){var a=o[i];a!==void 0&&!(i in r)&&(a.d(),o[i]=void 0)}else o={},n.U=o;for(var u in r){var c=o[u],_=r[u];c===void 0?(c=ln(n,u,_),o[u]=c):c.o(_,s)}for(var l in r)s[l]=r[l]}}t(e)});function ln(t,e,n,r){var s=e in t&&t.ownerSVGElement===void 0,o=R(n),i=n.peek();return{o:function(a,u){o.value=a,i=a.peek()},d:re(function(){this.N=At;var a=o.value.value;i!==a?(i=void 0,s?t[e]=a:a!=null&&(a!==!1||e[4]==="-")?t.setAttribute(e,a):t.removeAttribute(e)):i=void 0})}}Z("unmount",function(t,e){if(typeof e.type=="string"){var n=e.__e;if(n){var r=n.U;if(r){n.U=void 0;for(var s in r){var o=r[s];o&&o.d()}}}e.__np=void 0}else{var i=e.__c;if(i){var a=i.__$u;a&&(i.__$u=void 0,a.d())}}t(e)});Z("__h",function(t,e,n,r){(r<3||r===9)&&(e.__$f|=2),t(e,n,r)});K.prototype.shouldComponentUpdate=function(t,e){if(this.__R)return!0;var n=this.__$u,r=n&&n.s!==void 0;for(var s in e)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var o=2&this.__$f;if(!(r||o||4&this.__$f)||1&this.__$f)return!0}else if(!(r||4&this.__$f)||3&this.__$f)return!0;for(var i in t)if(i!=="__source"&&t[i]!==this.props[i])return!0;for(var a in this.props)if(!(a in t))return!0;return!1};function cn(t,e){return ge(function(){return R(t,e)},[])}var un=function(t){queueMicrotask(function(){queueMicrotask(t)})};function fn(){sn(function(){for(var t;t=Dt.shift();)Ut.call(t)})}function At(){Dt.push(this)===1&&(w.requestAnimationFrame||un)(fn)}class T extends Error{constructor(e,n){super(e),this.cause=n,this.name="CalDavError"}}const _n="modulepreload",dn=function(t){return"/"+t},et={},hn=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){let c=function(_){return Promise.all(_.map(l=>Promise.resolve(l).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};var i=c;document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=a?.nonce||a?.getAttribute("nonce");s=c(n.map(_=>{if(_=dn(_),_ in et)return;et[_]=!0;const l=_.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${h}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":_n,l||(f.as="script"),f.crossOrigin="",f.href=_,u&&f.setAttribute("nonce",u),document.head.appendChild(f),l)return new Promise((v,m)=>{f.addEventListener("load",v),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${_}`)))})}))}function o(a){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=a,window.dispatchEvent(u),!u.defaultPrevented)throw a}return s.then(a=>{for(const u of a||[])u.status==="rejected"&&o(u.reason);return e().catch(o)})},kt=3e4;function pn(){return typeof window<"u"&&"__TAURI_INTERNALS__"in window}const vn="https://isb-kalender.zit.mwn.de/caldav.php",tt="/api/caldav";function mn(t){try{const n=new URL(t).pathname;return tt+n}catch{return tt+"/"+t}}async function Be(t){return pn()?yn(t):gn(t)}async function yn(t){const{fetch:e}=await hn(async()=>{const{fetch:o}=await import("./index-C_oZa5pB.js");return{fetch:o}},[]),n=await e(t.url,{method:t.method,headers:t.headers,body:t.body,connectTimeout:kt}),r=await n.text(),s={};return n.headers.forEach((o,i)=>{s[i]=o}),{status:n.status,body:r,headers:s}}async function gn(t){const e=mn(t.url),n=new AbortController,r=setTimeout(()=>n.abort(),kt);try{const s=await fetch(e,{method:t.method,headers:t.headers,body:t.body,signal:n.signal}),o=await s.text(),i={};return s.headers.forEach((a,u)=>{i[u]=a}),{status:s.status,body:o,headers:i}}finally{clearTimeout(r)}}function Oe(t,e){return"Basic "+btoa(t+":"+e)}const wn=/^SUMMARY[;:](.*)/m,bn=/^DTSTART[;:](.*)/m,Sn=/^DTEND[;:](.*)/m,Tn=/^DURATION[;:](.*)/m,En=/^CLASS[;:](.*)/m,nt=/^FREEBUSY[;:](.*)/gm;function Cn(t,e){const n=[],r=t.replace(/\r?\n[ \t]/g,"");let s=0;for(;(s=r.indexOf("BEGIN:VEVENT",s))!==-1;){const o=r.indexOf("END:VEVENT",s);if(o===-1)break;const i=r.substring(s,o),a=X(i,wn),u=X(i,bn),c=X(i,Sn),_=X(i,Tn),l=X(i,En);if(u===null){s=o+1;continue}const h=xt(u),f=pe(u);let v=c!==null?pe(c):null;v===null&&_!==null&&f!==null&&(v=Rt(f,_.trim()));const m=l!==null?l.trim():"PUBLIC";if(h===null){s=o+1;continue}n.push({summary:a!==null?a.trim():"(No title)",date:h,startTime:f,endTime:v,status:m,accessible:!0}),s=o+1}return n}function $n(t){const e=[],n=t.replace(/\r?\n[ \t]/g,""),r=n.indexOf("BEGIN:VFREEBUSY"),s=n.indexOf("END:VFREEBUSY");if(r===-1||s===-1)return e;const o=n.substring(r,s);nt.lastIndex=0;let i;for(;(i=nt.exec(o))!==null;){const a=i[1].trim();let u="BUSY",c=a;const _=a.indexOf(":");if(_>=0&&a.includes("=")){const h=a.substring(0,_);c=a.substring(_+1).trim();const f=/FBTYPE=([A-Z-]+)/.exec(h);f&&(u=f[1])}const l=c.split(",");for(const h of l){const f=h.trim();if(f==="")continue;const v=f.indexOf("/");if(v===-1){console.warn("Invalid FREEBUSY period (no slash):",f);continue}const m=f.substring(0,v),b=f.substring(v+1),y=xt(m),p=pe(m);if(y===null){console.warn("Could not parse date from FREEBUSY period:",m);continue}let S;b.startsWith("P")?S=Rt(p,b):S=pe(b),e.push({summary:null,date:y,startTime:p,endTime:S,status:u,accessible:!1})}}return e}function X(t,e){const r=new RegExp(e.source,e.flags.replace("g","")).exec(t);if(r){const s=r[1],o=s.indexOf(":");return o>=0&&s.includes("=")?s.substring(o+1).trim():s.trim()}return null}function xt(t){try{const e=t.replace("Z","").trim();if(e.length>=8){const n=e.substring(0,4),r=e.substring(4,6),s=e.substring(6,8);return`${n}-${r}-${s}`}}catch{console.warn("Failed to parse iCal date:",t)}return null}function pe(t){try{const e=t.replace("Z","").trim();if(e.includes("T")&&e.length>=15){const n=e.substring(9),r=n.substring(0,2),s=n.substring(2,4);return`${r}:${s}`}}catch{console.warn("Failed to parse iCal time:",t)}return null}function Rt(t,e){if(t===null)return null;try{const[n,r]=t.split(":").map(Number);let s=n*60+r;const o=/^PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?$/.exec(e);if(!o)return console.warn("Failed to parse duration:",e),null;const i=o[1]?parseInt(o[1],10):0,a=o[2]?parseInt(o[2],10):0;s+=i*60+a;const u=Math.floor(s/60)%24,c=s%60;return`${String(u).padStart(2,"0")}:${String(c).padStart(2,"0")}`}catch{return console.warn("Failed to parse duration:",e),null}}function rt(t){return t.replace(/-/g,"")}const D="DAV:",Un="urn:ietf:params:xml:ns:caldav",Dn=`<?xml version="1.0" encoding="UTF-8"?>
<d:principal-property-search xmlns:d="DAV:" test="anyof">
  <d:property-search>
    <d:prop>
      <d:displayname/>
    </d:prop>
    <d:match>{{SEARCH_TERM}}</d:match>
  </d:property-search>
  <d:prop>
    <d:displayname/>
    <d:resourcetype/>
  </d:prop>
</d:principal-property-search>`,Nn=`<?xml version="1.0" encoding="UTF-8"?>
<c:calendar-query xmlns:d="DAV:"
                  xmlns:c="urn:ietf:params:xml:ns:caldav">
  <d:prop>
    <d:getetag/>
    <c:calendar-data>
      <c:expand start="{{START}}" end="{{END}}"/>
    </c:calendar-data>
  </d:prop>
  <c:filter>
    <c:comp-filter name="VCALENDAR">
      <c:comp-filter name="VEVENT">
        <c:time-range start="{{START}}" end="{{END}}"/>
      </c:comp-filter>
    </c:comp-filter>
  </c:filter>
</c:calendar-query>`,An=`<?xml version="1.0" encoding="UTF-8"?>
<c:free-busy-query xmlns:c="urn:ietf:params:xml:ns:caldav">
  <c:time-range start="{{START}}" end="{{END}}"/>
</c:free-busy-query>`;function kn(t){return Dn.replace("{{SEARCH_TERM}}",xn(t))}function xn(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function ve(t){let e=t.trim();return e.endsWith("/")||(e+="/"),!e.startsWith("http://")&&!e.startsWith("https://")&&(e="https://"+e),e}function Rn(t,e){if(e.startsWith("http://")||e.startsWith("https://"))return ve(e);const n=new URL(e,t).toString();return ve(n)}function Pn(t){const e=[];try{const r=new DOMParser().parseFromString(t,"application/xml"),s=r.querySelector("parsererror");if(s)throw new Error("XML parse error: "+s.textContent);const o=r.getElementsByTagNameNS(D,"response");for(let i=0;i<o.length;i++){const a=o[i],u=Mt(a,D,"href");if(u===null||!Pt(a)||!Mn(a))continue;let c=Ft(a,D,"displayname");(c===null||c.trim()==="")&&(c=u),e.push({displayName:c,href:u})}}catch(n){throw n instanceof T?n:new T("Failed to parse principal search response: "+(n instanceof Error?n.message:String(n)),n)}return e}function Fn(t,e){const n=[];try{const s=new DOMParser().parseFromString(t,"application/xml"),o=s.querySelector("parsererror");if(o)throw new Error("XML parse error: "+o.textContent);const i=s.getElementsByTagNameNS(D,"response");for(let a=0;a<i.length;a++){const u=i[a];if(!Pt(u))continue;const c=Ft(u,Un,"calendar-data");c===null||c.trim()===""||n.push(...Cn(c,e))}}catch(r){throw r instanceof T?r:new T("Failed to parse calendar query response: "+(r instanceof Error?r.message:String(r)),r)}return n}function Pt(t){const e=t.getElementsByTagNameNS(D,"propstat");for(let n=0;n<e.length;n++){const r=e[n],s=Mt(r,D,"status");if(s!==null&&s.includes("200"))return!0}return!1}function Mn(t){const e=t.getElementsByTagNameNS(D,"propstat");for(let n=0;n<e.length;n++){const s=e[n].getElementsByTagNameNS(D,"prop");for(let o=0;o<s.length;o++){const a=s[o].getElementsByTagNameNS(D,"resourcetype");for(let u=0;u<a.length;u++)if(a[u].getElementsByTagNameNS(D,"principal").length>0)return!0}}return!1}function Ft(t,e,n){const r=t.getElementsByTagNameNS(D,"propstat");for(let s=0;s<r.length;s++){const i=r[s].getElementsByTagNameNS(D,"prop");for(let a=0;a<i.length;a++){const c=i[a].getElementsByTagNameNS(e,n);if(c.length>0){const _=c[0].textContent;return _!==null&&_.trim()!==""?_.trim():null}}}return null}function Mt(t,e,n){const r=t.getElementsByTagNameNS(e,n);return r.length>0?r[0].textContent:null}async function Ln(t,e,n,r){const s=await Be({url:t,method:"REPORT",headers:{"Content-Type":"application/xml; charset=utf-8",Depth:"0",Authorization:Oe(e,n)},body:r});switch(s.status){case 207:return s.body;case 401:throw new T("Authentication failed. Please check your username and password.");case 403:throw new T("Access denied. You don't have permission to search principals.");case 404:throw new T("URL not found. Please check the URL.");default:throw new T(`Server returned unexpected status ${s.status}.`)}}async function Bn(t,e,n,r){const s=await Be({url:t,method:"REPORT",headers:{"Content-Type":"application/xml; charset=utf-8",Depth:"1",Authorization:Oe(e,n)},body:r});switch(s.status){case 207:return s.body;case 401:throw new T("Authentication failed. Please check your username and password.");case 403:throw new T("Access denied. You don't have permission to access this calendar.");case 404:throw new T("Calendar not found at this URL.");default:throw new T(`Server returned unexpected status ${s.status}.`)}}async function On(t,e,n,r){const s=await Be({url:t,method:"REPORT",headers:{"Content-Type":"application/xml; charset=utf-8",Depth:"1",Authorization:Oe(e,n)},body:r});switch(s.status){case 200:return s.body;case 401:throw new T("Authentication failed. Please check your username and password.");case 403:throw new T("Access denied. You don't have permission to view free/busy data for this calendar.");case 404:throw new T("Calendar not found at this URL.");default:throw new T(`Server returned unexpected status ${s.status}.`)}}function Lt(t,e,n){if(!t||t.trim()==="")throw new T("CalDAV URL must not be empty.");if(!e||e.trim()==="")throw new T("Username must not be empty.");if(!n||n.trim()==="")throw new T("Password must not be empty.")}async function Bt(t,e,n,r){if(Lt(t,e,n),!r||r.trim()==="")throw new T("Search term must not be empty.");try{const s=ve(t),o=kn(r),i=await Ln(s,e,n,o);return Pn(i)}catch(s){throw s instanceof T?s:new T("Failed to search users: "+(s instanceof Error?s.message:String(s)),s)}}async function In(t,e,n,r,s){Lt(t,n,r);try{const o=ve(t),i=e.endsWith("/")?e+"calendar/":e+"/calendar/",a=Rn(o,i),u=new Date(s+"T00:00:00Z"),c=new Date(u);c.setUTCDate(c.getUTCDate()+7);const _=c.getUTCFullYear().toString()+"-"+String(c.getUTCMonth()+1).padStart(2,"0")+"-"+String(c.getUTCDate()).padStart(2,"0"),l=rt(s)+"T000000Z",h=rt(_)+"T000000Z";let f;try{const v=Nn.replace(/\{\{START\}\}/g,l).replace(/\{\{END\}\}/g,h),m=await Bn(a,n,r,v);f=Fn(m,!0)}catch(v){if(v instanceof T&&v.message.includes("Access denied")){const m=An.replace(/\{\{START\}\}/g,l).replace(/\{\{END\}\}/g,h),b=await On(a,n,r,m);f=$n(b)}else throw v}return f.sort((v,m)=>{const b=v.date.localeCompare(m.date);return b!==0?b:v.startTime===null&&m.startTime===null?0:v.startTime===null?-1:m.startTime===null?1:v.startTime.localeCompare(m.startTime)}),f}catch(o){throw o instanceof T?o:new T("Failed to fetch events: "+(o instanceof Error?o.message:String(o)),o)}}const Hn="07:00",Wn="19:00",Ot=30,te=5,Yn=["Mon","Tue","Wed","Thu","Fri"];function Ie(){const t=[];let e=ke(Hn);const n=ke(Wn);for(;e<n;)t.push(It(e)),e+=Ot;return t}function Vn(){const t=[],e=Ie();for(let n=0;n<te;n++)for(const r of e)t.push(`${n}-${r}`);return t}function qn(t,e){return t.filter(n=>n.date===e)}function zn(t,e,n){return t.filter(r=>r.startTime===null||r.endTime===null?!0:r.startTime<n&&r.endTime>e)}function ae(t){switch(t.status){case"BUSY-UNAVAILABLE":return 3;case"BUSY":return 2;case"BUSY-TENTATIVE":return 1;default:return 2}}function Zn(t){let e=t[0];for(const n of t)(ae(n)>ae(e)||ae(n)===ae(e)&&n.accessible&&!e.accessible)&&(e=n);return e}function jn(t){if(t.accessible)return"slot-busy";switch(t.status){case"BUSY-TENTATIVE":return"slot-busy-tentative";case"BUSY-UNAVAILABLE":return"slot-busy-unavailable";default:return"slot-busy-fb"}}function Xn(t){if(t.accessible&&t.summary!==null){const e=t.summary;return e.length>8?e.substring(0,7)+"…":e}return null}function Jn(t,e,n){if(t.length===0)return null;const r=[];for(const s of t)if(s.accessible&&s.summary!==null){let o=s.summary;s.startTime!==null&&s.endTime!==null&&(o+=` (${J(s.startTime)} - ${J(s.endTime)})`),r.push(o)}else{let o=s.status;s.startTime!==null&&s.endTime!==null&&(o+=` (${J(s.startTime)} - ${J(s.endTime)})`),r.push(o)}return r.join(`
`)}function Kn(t,e,n){const r={},s=Ie();for(let o=0;o<te;o++){const i=Ht(e,o),a=qn(t,i);for(const u of s){const c=`${o}-${u}`,_=er(u,Ot);if(n){r[c]={cssClass:"schedule-error-cell",label:"?",tooltip:"Failed to load",busy:!0};continue}const l=zn(a,u,_);if(l.length===0)r[c]={cssClass:"",label:null,tooltip:null,busy:!1};else{const h=Zn(l),f=jn(h),v=Xn(h),m=Jn(l);r[c]={cssClass:f,label:v,tooltip:m,busy:!0}}}}return r}function Gn(t){const e={},n=Vn();for(const r of n)t.every(o=>{const i=o.slots[r];return i===void 0||!i.busy})?e[r]={cssClass:"slot-all-free",label:null,tooltip:"All users are free",busy:!1}:e[r]={cssClass:"slot-not-all-free",label:null,tooltip:null,busy:!0};return e}function Qn(t,e,n,r){const s=[];for(const i of t){const a=e.get(i.href)??[],u=n.has(i.href),c=Kn(a,r,u);s.push({user:i,slots:c})}const o=Gn(s);return s.push({user:null,slots:o}),s}function ke(t){const[e,n]=t.split(":").map(Number);return e*60+n}function It(t){const e=Math.floor(t/60)%24,n=t%60;return`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}`}function er(t,e){return It(ke(t)+e)}function Ht(t,e){const n=new Date(t+"T00:00:00Z");return n.setUTCDate(n.getUTCDate()+e),n.getUTCFullYear().toString()+"-"+String(n.getUTCMonth()+1).padStart(2,"0")+"-"+String(n.getUTCDate()).padStart(2,"0")}function J(t){return t.startsWith("0")?t.substring(1):t}function Wt(t){const e=new Date,n=e.getDay(),r=n===0?-6:1-n;return e.setDate(e.getDate()+r),e.getFullYear().toString()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")}function tr(t){const e=new Date(t+"T00:00:00Z"),n=new Date(e);n.setUTCDate(n.getUTCDate()+4);const r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=r[e.getUTCMonth()],o=e.getUTCDate(),i=r[n.getUTCMonth()],a=n.getUTCDate(),u=e.getUTCFullYear();return`${s} ${o} - ${i} ${a}, ${u}`}function nr(t,e){const n=Ht(t,e),r=new Date(n+"T00:00:00Z"),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return`${Yn[e]} ${s[r.getUTCMonth()]} ${r.getUTCDate()}`}const U=R(null),I=R(!1),A=R([]),F=R(new Map),N=R(new Set),H=R(Wt()),st=R(!1),O=R(!0),rr=Ae(()=>{const t=A.value;return t.length===0?[]:Qn(t,F.value,N.value,H.value)});async function sr(t,e,n){st.value=!0;try{return await Bt(t,e,n,"a"),U.value={url:t,username:e,password:n},I.value=!0,O.value=!1,null}catch(r){return r instanceof T||r instanceof Error?r.message:"Unknown error"}finally{st.value=!1}}async function or(t){A.value.some(e=>e.href===t.href)||(A.value=[...A.value,t],await Vt(t))}function ir(t){A.value=A.value.filter(r=>r.href!==t.href);const e=new Map(F.value);e.delete(t.href),F.value=e;const n=new Set(N.value);n.delete(t.href),N.value=n}async function ot(t){const e=new Date(H.value+"T00:00:00Z");e.setUTCDate(e.getUTCDate()+t*7),H.value=e.getUTCFullYear().toString()+"-"+String(e.getUTCMonth()+1).padStart(2,"0")+"-"+String(e.getUTCDate()).padStart(2,"0"),await Yt()}async function ar(){H.value=Wt(),await Yt()}async function Yt(){F.value=new Map,N.value=new Set;const t=A.value.map(e=>Vt(e));await Promise.all(t)}function lr(){I.value=!1,U.value=null,A.value=[],F.value=new Map,N.value=new Set,O.value=!0}async function cr(t){if(!I.value||U.value===null)return[];try{const e=await Bt(U.value.url,U.value.username,U.value.password,t),n=new Set(A.value.map(r=>r.href));return e.filter(r=>!n.has(r.href))}catch{return[]}}async function Vt(t){if(U.value===null)return"Not connected";try{const e=await In(U.value.url,t.href,U.value.username,U.value.password,H.value),n=new Map(F.value);if(n.set(t.href,e),F.value=n,N.value.has(t.href)){const r=new Set(N.value);r.delete(t.href),N.value=r}return null}catch(e){const n=new Map(F.value);n.set(t.href,[]),F.value=n;const r=new Set(N.value);return r.add(t.href),N.value=r,e instanceof T||e instanceof Error?e.message:"Unknown error"}}function ur(){const t=I.value,e=U.value?.username,n=()=>{O.value=!0},r=()=>{lr()};return d("div",{class:"toolbar",children:[d("h1",{class:"toolbar-title",children:"Planner"}),d("div",{class:"toolbar-actions",children:[d("span",{class:"connection-status",style:{color:t?"var(--cv-success-text)":"var(--cv-text-secondary)"},children:t?`Connected as ${e}`:"Not connected"}),t&&d("button",{class:"btn btn-secondary btn-small",onClick:r,children:"Disconnect"}),d("button",{class:"btn btn-primary",onClick:n,children:t?"Reconnect":"Connect"})]})]})}function fr({onNotification:t}){const e=V(null),n=V(null),r=V(null),[s,o]=B(!1);if($e(()=>{O.value&&requestAnimationFrame(()=>{e.current&&!e.current.value?e.current.focus():n.current&&!n.current.value?n.current.focus():r.current&&r.current.focus()})},[O.value]),!O.value)return null;const i=async()=>{const l=e.current?.value??"",h=n.current?.value??"",f=r.current?.value??"";if(!l.trim()||!h.trim()||!f.trim()){t?.("Please fill in all fields.","warning");return}o(!0);const v=await sr(l.trim(),h.trim(),f);o(!1),v?t?.(v,"error"):t?.("Connected successfully. You can now search for users.","success")},a=()=>{O.value=!1},u=l=>{l.key==="Enter"&&!s&&i(),l.key==="Escape"&&I.value&&a()},c=U.value?.url??vn,_=U.value?.username??"";return d("div",{class:"login-overlay",onKeyDown:u,children:d("div",{class:"login-dialog",children:[d("div",{class:"login-dialog-header",children:d("h2",{children:"Connect to CalDAV Server"})}),d("div",{class:"login-dialog-body",children:[d("div",{class:"form-field",children:[d("label",{for:"login-url",children:"CalDAV URL"}),d("input",{ref:e,id:"login-url",type:"text",value:c,placeholder:"https://...",disabled:s})]}),d("div",{class:"form-field",children:[d("label",{for:"login-username",children:"Username"}),d("input",{ref:n,id:"login-username",type:"text",value:_,placeholder:"Username",disabled:s})]}),d("div",{class:"form-field",children:[d("label",{for:"login-password",children:"Password"}),d("input",{ref:r,id:"login-password",type:"password",placeholder:"Password",disabled:s})]})]}),d("div",{class:"login-dialog-footer",children:[I.value&&d("button",{class:"btn btn-secondary",onClick:a,disabled:s,children:"Cancel"}),d("button",{class:"btn btn-primary",onClick:i,disabled:s,children:s?"Connecting...":"Connect"})]})]})})}const it=2,_r=300;function dr(){const[t,e]=B(""),[n,r]=B([]),[s,o]=B(!1),[i,a]=B(!1),[u,c]=B(-1),_=V(null),l=V(null),h=V(null),f=!I.value,v=Ue(async p=>{if(p.length<it){r([]),o(!1);return}a(!0);const S=await cr(p);r(S),o(S.length>0),c(-1),a(!1)},[]),m=p=>{const S=p.target.value;e(S),h.current!==null&&clearTimeout(h.current),h.current=setTimeout(()=>{v(S)},_r)},b=async p=>{e(""),r([]),o(!1),c(-1),await or(p),_.current?.focus()},y=p=>{!s||n.length===0||(p.key==="ArrowDown"?(p.preventDefault(),c(S=>S<n.length-1?S+1:0)):p.key==="ArrowUp"?(p.preventDefault(),c(S=>S>0?S-1:n.length-1)):p.key==="Enter"&&u>=0?(p.preventDefault(),b(n[u])):p.key==="Escape"&&(o(!1),c(-1)))};return $e(()=>{const p=S=>{const k=S.target;_.current&&!_.current.contains(k)&&l.current&&!l.current.contains(k)&&o(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]),$e(()=>()=>{h.current!==null&&clearTimeout(h.current)},[]),d("div",{class:"user-search",children:[d("label",{class:"user-search-label",for:"user-search-input",children:"Search Users"}),d("div",{class:"user-search-input-wrapper",children:[d("svg",{class:"user-search-icon",viewBox:"0 0 24 24",width:"18",height:"18",children:d("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),d("input",{ref:_,id:"user-search-input",type:"text",class:"user-search-input",placeholder:f?"Connect to search users":`Type at least ${it} characters to search...`,value:t,onInput:m,onKeyDown:y,onFocus:()=>{n.length>0&&o(!0)},disabled:f}),i&&d("span",{class:"user-search-spinner"})]}),s&&n.length>0&&d("ul",{ref:l,class:"user-search-dropdown",children:n.map((p,S)=>d("li",{class:`user-search-item${S===u?" highlighted":""}`,onMouseDown:()=>b(p),onMouseEnter:()=>c(S),children:[d("span",{class:"user-search-item-name",children:p.displayName}),d("span",{class:"user-search-item-href",children:p.href})]},p.href))})]})}function hr(){const t=A.value.length>0,e=H.value,n=tr(e);return d("div",{class:"week-nav",children:[d("button",{class:"btn btn-tertiary",onClick:()=>ot(-1),disabled:!t,title:"Previous week",children:"❮"}),d("button",{class:"btn btn-tertiary",onClick:()=>ar(),disabled:!t,children:"Today"}),d("span",{class:"week-label",children:n}),d("button",{class:"btn btn-tertiary",onClick:()=>ot(1),disabled:!t,title:"Next week",children:"❯"})]})}function pr(){const t=rr.value;if(A.value.length===0)return d("div",{class:"schedule-empty",children:"No users selected. Use the search box above to find and add users."});const n=Ie(),r=H.value,s=N.value;return d("div",{class:"schedule-scroll-container",children:d("table",{class:"schedule-table",children:[d(vr,{weekStart:r,timeSlots:n}),d(mr,{rows:t,timeSlots:n,failedUsers:s})]})})}function vr({weekStart:t,timeSlots:e}){return d("thead",{children:[d("tr",{children:[d("th",{class:"schedule-corner-cell",rowSpan:2,children:"User"}),Array.from({length:te},(n,r)=>d("th",{class:`schedule-day-header${r>0?" day-separator":""}`,colSpan:e.length,children:nr(t,r)},r))]}),d("tr",{children:Array.from({length:te},(n,r)=>e.map((s,o)=>{const i=s.endsWith(":00");return d("th",{class:`schedule-time-header${o===0&&r>0?" day-separator":""}`,children:i?J(s):""},`${r}-${s}`)}))})]})}function mr({rows:t,timeSlots:e,failedUsers:n}){return d("tbody",{children:t.map((r,s)=>d(yr,{row:r,timeSlots:e,isFailed:r.user!==null&&n.has(r.user.href),isLastRow:s===t.length-1},r.user?.href??"__all_free__"))})}function yr({row:t,timeSlots:e,isFailed:n,isLastRow:r}){const s=t.user===null;return d("tr",{class:s?"schedule-summary-row":"schedule-user-row",children:[d("td",{class:"schedule-user-cell-td",children:s?d("span",{class:"schedule-summary-cell",children:"All Free"}):d("div",{class:"schedule-user-cell",children:[n&&d("svg",{class:"user-warning-icon",viewBox:"0 0 24 24",width:"16",height:"16",title:"Failed to load events",children:d("path",{fill:"currentColor",d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),d("span",{class:"user-name",children:t.user.displayName}),d("button",{class:"btn-remove-user",onClick:()=>ir(t.user),title:`Remove ${t.user.displayName}`,children:"×"})]})}),Array.from({length:te},(o,i)=>e.map((a,u)=>{const c=`${i}-${a}`,_=t.slots[c],l=u===0;return d("td",{class:`schedule-cell${_?.cssClass?` ${_.cssClass}`:""}${l&&i>0?" day-separator":""}`,title:_?.tooltip??void 0,children:_?.label??""},c)}))]})}function gr({toasts:t,onDismiss:e}){return t.length===0?null:d("div",{class:"toast-container",children:t.map(n=>d("div",{class:`toast toast-${n.variant}`,onClick:()=>e(n.id),role:"alert",children:[d("span",{class:"toast-message",children:n.message}),d("button",{class:"toast-close",onClick:r=>{r.stopPropagation(),e(n.id)},"aria-label":"Dismiss",children:"×"})]},n.id))})}let wr=0;function br(){const[t,e]=B([]),n=Ue((s,o)=>{const i=wr++;e(u=>[...u,{id:i,message:s,variant:o}]),setTimeout(()=>{e(u=>u.filter(c=>c.id!==i))},o==="error"?5e3:3e3)},[]),r=Ue(s=>{e(o=>o.filter(i=>i.id!==s))},[]);return d("div",{class:"app-root",children:[d(ur,{}),d(fr,{onNotification:n}),d("div",{class:"app-content",children:[d(dr,{}),d(hr,{}),d(pr,{})]}),d(gr,{toasts:t,onDismiss:r})]})}Gt(d(br,{}),document.getElementById("app"));
